+++
date = '2018-07-24'
title = 'event or callback'
tags = ['code review']
+++

又是 code review 的讨论的一个问题。需要进行操作的时候，应该由子组件向上传递事件，还是父组件向下传递回调？

如果按照 `data down, actions up` 判断，显然应该使用事件的方式。
但是，回顾近期所写的代码时，发现自己大量使用了回调。
虽然这不是什么深思熟虑后的判断，但是还是来试着分析下为何这么实现。

---

事件与回调的问题，会让我想起 promise。
以前看过一篇文章，说 promise 的核心是信任。
借助 promise，上层逻辑的开发者，能主动控制异步的后续行为。
而传递回调的方式，将逻辑控制权交给了异步函数，是否调用、如何调用，对上层的开发者而言都是一个黑盒。

回到组件交互的场景，这个操作，逻辑上应该属于子组件还是父组件。这可以作为一个判断的依据。

---

主动被动，还会让人联想到框架与库。库是基本函数的集合，由调用者主动进行调用。框架则相反，使用者实现特定接口，如何运行则由框架调度。

简单组件，应该更近似于库函数，可以使用事件的方式交互。而复杂业务场景，可能类似于框架，可以使用回调的方式交互。

---

最后想要提及的是组合。使用回调的方式，可以在调用前后，进行类似 AOP 的操作，插入一些处理。而使用事件的方式无法实现这种操作。

虽然想说事件可以实现一对多的信息传递，不过组件的场景里，主要都是父子组件通信，这个优势并不明显。
